/**
 * print-styles.css - Styles d'impression optimisés pour GoPrint
 * 
 * Ce fichier contient toutes les règles CSS qui contrôlent l'apparence
 * des pages lors de l'impression ou de l'export PDF.
 * 
 * Ces styles sont injectés dans la page AVANT le script de nettoyage
 * pour garantir qu'ils sont bien pris en compte par le navigateur.
 */

/* ========================================================================
   CONFIGURATION GLOBALE DE LA PAGE
   ======================================================================== */

/**
 * La règle @page contrôle les propriétés physiques de la page imprimée
 * comme les marges, la taille du papier et l'orientation.
 */
@page {
  /* Marges uniformes sur tous les côtés */
  margin: 1.5cm;
  
  /* Format de papier standard A4 */
  size: A4 portrait;
  
  /* Suppression des en-têtes et pieds de page par défaut du navigateur */
  /* Ces en-têtes contiennent généralement l'URL, la date et le numéro de page */
  margin-top: 0;
  margin-bottom: 0;
}

/**
 * Tous les styles ci-dessous sont enveloppés dans @media print
 * pour qu'ils ne s'appliquent QUE lors de l'impression et n'affectent
 * pas l'affichage normal à l'écran.
 */
@media print {

  /* ========================================================================
     RÉINITIALISATION ET STYLES DE BASE
     ======================================================================== */

  /**
   * Réinitialisation globale pour s'assurer que tous les éléments
   * utilisent le modèle de boîte border-box, ce qui facilite grandement
   * les calculs de largeur et évite les débordements.
   */
  * {
    box-sizing: border-box !important;
  }

  /**
   * Configuration du corps du document pour une lisibilité optimale
   */
  body {
    /* Suppression de toute couleur de fond */
    background: white !important;
    
    /* Texte en noir pur pour un contraste maximal */
    color: black !important;
    
    /* Taille de police optimale pour la lecture sur papier */
    font-size: 11pt !important;
    
    /* Espacement vertical qui améliore la lisibilité */
    line-height: 1.6 !important;
    
    /* Police classique adaptée à l'impression */
    font-family: Georgia, 'Times New Roman', serif !important;
    
    /* Suppression des marges par défaut */
    margin: 0 !important;
    padding: 0 !important;
    
    /* Utilisation de toute la largeur disponible */
    width: 100% !important;
    max-width: 100% !important;
  }

  /* ========================================================================
     CONTRÔLE DES SAUTS DE PAGE
     ======================================================================== */

  /**
   * Ces règles empêchent la coupure de certains éléments entre deux pages.
   * La coupure d'un bloc de code ou d'une image au milieu rend le document
   * difficile à lire et peu professionnel.
   */

  /* Blocs de code et citations : jamais coupés */
  pre,
  code,
  blockquote,
  .highlight,
  .code-block {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }

  /* Images : toujours gardées sur une seule page */
  img,
  figure,
  .image-container {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
    max-width: 100% !important;
    height: auto !important;
  }

  /* Tableaux : éviter de couper au milieu d'une ligne */
  table,
  tr {
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }

  /**
   * Les titres ne doivent jamais être séparés du contenu qui les suit.
   * Un titre seul en bas de page sans son contenu crée une mise en page
   * confuse et peu professionnelle.
   */
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid !important;
    break-after: avoid !important;
    page-break-inside: avoid !important;
    break-inside: avoid !important;
  }

  /**
   * Les listes doivent rester groupées avec leurs éléments parents
   */
  ul, ol, dl {
    page-break-before: avoid !important;
    break-before: avoid !important;
  }

  /* ========================================================================
     OPTIMISATION DE LA TYPOGRAPHIE
     ======================================================================== */

  /**
   * Hiérarchie claire des titres pour une navigation facile dans le document
   */
  h1 {
    font-size: 24pt !important;
    margin-top: 18pt !important;
    margin-bottom: 12pt !important;
    font-weight: bold !important;
    color: #000 !important;
  }

  h2 {
    font-size: 20pt !important;
    margin-top: 16pt !important;
    margin-bottom: 10pt !important;
    font-weight: bold !important;
    color: #000 !important;
  }

  h3 {
    font-size: 16pt !important;
    margin-top: 14pt !important;
    margin-bottom: 8pt !important;
    font-weight: bold !important;
    color: #000 !important;
  }

  h4, h5, h6 {
    font-size: 13pt !important;
    margin-top: 12pt !important;
    margin-bottom: 6pt !important;
    font-weight: bold !important;
    color: #000 !important;
  }

  /**
   * Espacement optimal des paragraphes pour une lecture confortable
   */
  p {
    margin-top: 0 !important;
    margin-bottom: 12pt !important;
    text-align: justify !important;
    orphans: 3 !important;
    widows: 3 !important;
  }

  /* ========================================================================
     MISE EN FORME DU CODE SOURCE
     ======================================================================== */

  /**
   * Les blocs de code nécessitent une attention particulière car ils sont
   * au cœur de la documentation technique que GoPrint vise à optimiser.
   */

  /* Blocs de code multi-lignes */
  pre {
    background: #f5f5f5 !important;
    border: 1px solid #ddd !important;
    border-radius: 4px !important;
    padding: 12pt !important;
    margin: 12pt 0 !important;
    font-family: 'Courier New', Courier, monospace !important;
    font-size: 9pt !important;
    line-height: 1.4 !important;
    overflow: visible !important;
    white-space: pre-wrap !important;
    word-wrap: break-word !important;
  }

  /* Code inline dans le texte */
  code {
    background: #f0f0f0 !important;
    border: 1px solid #e0e0e0 !important;
    border-radius: 3px !important;
    padding: 2pt 4pt !important;
    font-family: 'Courier New', Courier, monospace !important;
    font-size: 9pt !important;
    color: #000 !important;
  }

  /* Code à l'intérieur d'un bloc pre : pas de styles additionnels */
  pre code {
    background: transparent !important;
    border: none !important;
    padding: 0 !important;
  }

  /* ========================================================================
     LIENS HYPERTEXTES
     ======================================================================== */

  /**
   * Les liens doivent rester visibles et leur URL doit être accessible
   * même sur un document papier.
   */
  a {
    color: #000 !important;
    text-decoration: underline !important;
  }

  /**
   * Affichage de l'URL complète après le texte du lien
   * Cette règle est complétée par le formatage JavaScript dans cleaner.js
   */
  a[href^="http"]:after {
    content: " (" attr(href) ")" !important;
    font-size: 0.85em !important;
    color: #666 !important;
    word-wrap: break-word !important;
  }

  /* Éviter d'afficher les URLs pour les liens internes */
  a[href^="#"]:after {
    content: "" !important;
  }

  /* ========================================================================
     TABLEAUX
     ======================================================================== */

  /**
   * Mise en forme des tableaux pour une lisibilité optimale
   */
  table {
    width: 100% !important;
    border-collapse: collapse !important;
    margin: 12pt 0 !important;
    font-size: 10pt !important;
  }

  th, td {
    border: 1px solid #ddd !important;
    padding: 8pt !important;
    text-align: left !important;
  }

  th {
    background: #f5f5f5 !important;
    font-weight: bold !important;
  }

  /* ========================================================================
     LISTES
     ======================================================================== */

  ul, ol {
    margin: 12pt 0 !important;
    padding-left: 24pt !important;
  }

  li {
    margin-bottom: 6pt !important;
    line-height: 1.5 !important;
  }

  /* ========================================================================
     CITATIONS
     ======================================================================== */

  blockquote {
    margin: 12pt 24pt !important;
    padding: 12pt !important;
    border-left: 4px solid #ddd !important;
    background: #f9f9f9 !important;
    font-style: italic !important;
  }

  /* ========================================================================
     ÉLÉMENTS À MASQUER LORS DE L'IMPRESSION
     ======================================================================== */

  /**
   * Ces éléments sont soit déjà supprimés par cleaner.js, soit doivent
   * être masqués pour garantir qu'ils n'apparaissent pas dans l'impression.
   * Cette règle agit comme un filet de sécurité.
   */
  video,
  audio,
  canvas,
  .no-print,
  [aria-hidden="true"] {
    display: none !important;
  }

  /* ========================================================================
     OPTIMISATION DES COULEURS POUR L'ENCRE
     ======================================================================== */

  /**
   * Conversion des fonds de couleur en gris clair pour économiser l'encre
   * tout en conservant la structure visuelle du document.
   */
  *[style*="background-color"],
  *[style*="background:"] {
    background: #f9f9f9 !important;
  }

  /* Suppression des ombres qui consomment beaucoup d'encre */
  * {
    box-shadow: none !important;
    text-shadow: none !important;
  }

  /* ========================================================================
     IMAGES ET MÉDIAS
     ======================================================================== */

  /**
   * Optimisation des images pour l'impression
   */
  img {
    max-width: 100% !important;
    height: auto !important;
    display: block !important;
    margin: 12pt auto !important;
  }

  /* Légendes des images */
  figcaption {
    font-size: 9pt !important;
    font-style: italic !important;
    text-align: center !important;
    margin-top: 6pt !important;
    color: #666 !important;
  }

}